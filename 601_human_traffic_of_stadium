select id, visit_date, people
from (
select *, 
    row_number() over (order by id rows between 2 preceding and current row) r1,
    row_number() over (order by id rows between 1 preceding and 1 following) r2,
    row_number() over (order by id rows between current row and 2 following) r3
from Stadium 
where people >= 100)t
where r1 =3 or r2 =3 or r3 = 3
order by visit_date
### wrong
###1)should use count(*) or count(id) to get the number of ids
###2)should use range instead of rows to get consecutive id because 'rows' can't identify the value of the id but 'range' can


select ID, visit_date, people, 
count(*) over (order by timestamp(visit_date) range between current row and 2 following) follow_cnt, ### or order by id
count(*) over (order by timestamp(visit_date) range between 2 preceding and current row) prec_cnt,
count(*) over (order by timestamp(visit_date) range between 1 preceding and 1 following) curr_cnt
from Stadium
where people >= 100
