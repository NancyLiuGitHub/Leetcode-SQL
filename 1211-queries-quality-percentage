SELECT query_name, round(avg(rating/position),2) as quality, round(100 * sum(if(rating<3,1,0))/count(*),2) as poor_query_percentage
FROM queries
GROUP BY query_name
