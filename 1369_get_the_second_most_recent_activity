user has one activity
or second most recent activity

SELECT *
FROM useractivity
WEHRE username in (select username from useractivity group by username having count(activity) = 1)
union
SELECT *
FROM (
  SELECT *, rank() over (partition by username ORDER BY enddate desc) as r
  FROM useractivity
) t 
WHERE r = 2


