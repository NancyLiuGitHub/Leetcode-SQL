with cte as (
SELECT customer_id, 
sum(case when product_name = 'A' then 1 else 0 end) as a,
sum(case when product_name = 'B' then 1 else 0 end) as b,
sum(case when product_name = 'C' then 1 else 0 end) as c
FROM orders
GROUP BY customer_id )

SELECT cte.customer_id, customer_name
FROM cte join customers
where a >0 and b>0 and c=0

