select student_id, min(course_id), grade
from enrollment
where (student_id, grade) IN (
select student_id, max(grade)
from enrollment
group by student_id)
group by student_id, grade
order by student_id
